<div class="space-y-6">
  <div>
    <h1 class="text-2xl font-semibold text-zinc-100">Applications</h1>

    <div class="flex items-center justify-end mb-8">
      <button
        class="bg-cyan-600 hover:bg-cyan-700 text-white text-sm px-4 py-2 rounded-md"
        (click)="openCreateModal()"
      >
        + Create App
      </button>

      <!-- Create App Modal -->
      <div
        *ngIf="showCreateModal"
        class="fixed inset-0 bg-black/60 flex items-center justify-center z-50"
      >
        <div class="bg-zinc-900 border border-zinc-800 rounded-lg w-full max-w-md p-6 space-y-4">
          <h3 class="text-lg font-semibold text-zinc-100">Create Application</h3>

          <!-- App Name -->
          <div>
            <label class="text-sm text-zinc-400">Name</label>
            <input
              type="text"
              class="mt-1 w-full bg-zinc-900 border border-zinc-700 rounded-md px-3 py-2 text-zinc-100"
              [(ngModel)]="newApp.name"
            />
          </div>

          <!-- Description -->
          <div>
            <label class="text-sm text-zinc-400">Description</label>
            <textarea
              rows="3"
              class="mt-1 w-full bg-zinc-900 border border-zinc-700 rounded-md px-3 py-2 text-zinc-100"
              [(ngModel)]="newApp.description"
            ></textarea>
          </div>

          <!-- Actions -->
          <div class="flex justify-end gap-3 pt-2">
            <button class="text-zinc-400 hover:text-zinc-200 text-sm" (click)="closeCreateModal()">
              Cancel
            </button>
            <button
              class="bg-cyan-600 hover:bg-cyan-700 text-white text-sm px-4 py-2 rounded-md"
              (click)="submitCreateApp()"
            >
              Create
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="flex gap-4 border-b border-zinc-800 text-sm">
    <button (click)="setTab('all')" [class.text-cyan-400]="activeTab === 'all'" class="pb-2">
      All Applications
    </button>

    <button (click)="setTab('owned')" [class.text-cyan-400]="activeTab === 'owned'" class="pb-2">
      My Apps
    </button>
  </div>

  <!-- Loading -->
  <p *ngIf="loading" class="text-zinc-400">Loading applications…</p>

  <!-- Error -->
  <p *ngIf="error" class="text-red-400">Failed to load applications.</p>

  <!-- All Applications -->
  <div class="mt-8" *ngIf="activeTab === 'all'">
    <div class="overflow-x-auto border border-zinc-800 rounded-lg">
      <table class="min-w-full text-sm text-left">
        <thead class="bg-zinc-900 border-b border-zinc-800">
          <tr>
            <th class="px-4 py-3 text-zinc-400">Name</th>
            <th class="px-4 py-3 text-zinc-400">Slug</th>
            <th class="px-4 py-3 text-zinc-400">Description</th>
            <th class="px-4 py-3 text-zinc-400">Owner</th>
            <th class="px-4 py-3 text-zinc-400 text-right">Actions</th>
          </tr>
        </thead>

        <tbody>
          <tr
            *ngFor="let app of allApps"
            class="border-b border-zinc-800 hover:bg-zinc-900 transition"
          >
            <td class="px-4 py-3 text-zinc-100 font-medium">
              {{ app.name }}
            </td>

            <td class="px-4 py-3 text-zinc-400">
              {{ app.slug }}
            </td>

            <td class="px-4 py-3 text-zinc-500">
              {{ app.description || '—' }}
            </td>

            <td class="px-4 py-3 text-zinc-400">
              {{ app.poc_user_email }}
            </td>

            <td class="px-4 py-3 text-right">
              <button
                class="text-cyan-400 hover:text-cyan-300 text-xs font-medium"
                (click)="viewRoles(app.id)"
              >
                View Roles →
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Owned Apps -->
  <div class="mt-8" *ngIf="activeTab === 'owned'">
    <div *ngIf="ownedApps.length === 0" class="text-zinc-500 text-sm">
      You don’t own any applications yet.
    </div>

    <div *ngIf="ownedApps.length" class="overflow-x-auto border border-zinc-800 rounded-lg">
      <table class="min-w-full text-sm text-left">
        <thead class="bg-zinc-900 border-b border-zinc-800">
          <tr>
            <th class="px-4 py-3 text-zinc-400">Name</th>
            <th class="px-4 py-3 text-zinc-400">Slug</th>
            <th class="px-4 py-3 text-zinc-400">Description</th>
            <th class="px-4 py-3 text-zinc-400 text-right">Actions</th>
          </tr>
        </thead>

        <tbody>
          <tr
            *ngFor="let app of ownedApps"
            class="border-b border-zinc-800 hover:bg-zinc-900 transition"
          >
            <td class="px-4 py-3 text-zinc-100 font-medium">
              {{ app.name }}
            </td>

            <td class="px-4 py-3 text-zinc-400">
              {{ app.slug }}
            </td>

            <td class="px-4 py-3 text-zinc-500">
              {{ app.description || '—' }}
            </td>

            <td class="px-4 py-3 text-right">
              <button
                class="text-cyan-400 hover:text-cyan-300 text-xs font-medium"
                (click)="viewRoles(app.id)"
              >
                View Roles →
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
